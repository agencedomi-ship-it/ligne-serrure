export async function onRequest(context) {
    var TEL = "09 80 80 89 05";
    var TEL_CLEAN = TEL.replace(/\s/g, "");
    var MARQUE = "Ligne-Serrure";
    
    var html = '<!DOCTYPE html><html lang="fr"><head>';
    html += '<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!="dataLayer"?"&l="+l:"";j.async=true;j.src="https://www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f);})(window,document,"script","dataLayer","GTM-MFN4PQQD");</script>';
    html += '<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">';
    html += '<title>' + MARQUE + ' | Serrurier Urgence 24h/24</title>';
    html += '<meta name="description" content="Serrurier urgence 24h/24. Intervention en 20 minutes. Devis gratuit.">';
    html += '<link rel="icon" type="image/png" href="/images/favicon.png">';
    html += '<link rel="apple-touch-icon" href="/images/favicon.png">';
    html += '<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">';
    html += '<style>';
    html += ':root{--green:#22C55E;--red:#DC2626;--orange:#F59E0B;--dark:#111;--gray:#6B7280;--gray-light:#1F2937;--white:#FFFFFF}';
    html += '*{margin:0;padding:0;box-sizing:border-box}body{font-family:"Open Sans",sans-serif;color:var(--white);background:var(--dark)}h1,h2,h3{font-family:"Oswald",sans-serif;font-weight:700}';
    html += '@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes glow{0%,100%{box-shadow:0 0 20px rgba(245,158,11,0.5)}50%{box-shadow:0 0 40px rgba(245,158,11,0.8)}}';
    html += 'header{background:var(--dark);border-bottom:1px solid var(--gray-light);padding:15px 0}.header-inner{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}.logo{display:flex;align-items:center;gap:10px;text-decoration:none}.logo-icon{width:50px;height:50px;border-radius:10px;overflow:hidden}.logo-icon img{width:100%;height:100%;object-fit:cover}.logo-text{font-family:"Oswald",sans-serif;font-size:24px;color:var(--white)}.logo-text span{color:var(--orange)}.header-phone{display:flex;align-items:center;gap:8px;background:var(--green);color:var(--white);padding:12px 25px;border-radius:50px;text-decoration:none;font-weight:700;animation:pulse 2s infinite}.header-phone svg{width:20px;height:20px;fill:var(--white)}';
    html += '.hero{background:linear-gradient(rgba(0,0,0,0.7),rgba(0,0,0,0.7)),url("/images/camion.png") center/cover;padding:100px 0;text-align:center}.hero h1{font-size:52px;margin-bottom:20px;text-transform:uppercase}.hero h1 span{color:var(--orange)}.hero p{font-size:20px;margin-bottom:30px;color:#9CA3AF}.hero-buttons{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}.btn-call{display:inline-flex;align-items:center;gap:10px;background:var(--green);color:var(--white);padding:18px 40px;border-radius:50px;text-decoration:none;font-family:"Oswald",sans-serif;font-size:20px;animation:pulse 2s infinite}.btn-call svg{width:24px;height:24px;fill:var(--white)}.btn-search{display:inline-flex;align-items:center;gap:10px;background:transparent;color:var(--orange);padding:18px 40px;border-radius:50px;text-decoration:none;font-family:"Oswald",sans-serif;font-size:20px;border:2px solid var(--orange)}';
    html += '.search-section{padding:60px 0;background:var(--gray-light)}.search-box{max-width:700px;margin:0 auto;text-align:center;padding:0 20px}.search-box h2{font-size:36px;margin-bottom:10px}.search-box h2 span{color:var(--orange)}.search-box p{color:#9CA3AF;margin-bottom:25px}.search-form{display:flex;gap:10px}.search-form input{flex:1;padding:18px 20px;background:var(--dark);border:2px solid #374151;border-radius:50px;font-size:16px;color:var(--white)}.search-form input::placeholder{color:#6B7280}.search-form input:focus{outline:none;border-color:var(--orange)}.search-form button{background:var(--orange);color:var(--dark);border:none;padding:18px 35px;border-radius:50px;font-family:"Oswald",sans-serif;font-size:16px;cursor:pointer;font-weight:700}';
    html += '.features{padding:80px 0;background:var(--dark)}.features-grid{max-width:1200px;margin:0 auto;padding:0 20px;display:grid;grid-template-columns:repeat(4,1fr);gap:30px}.feature-card{background:var(--gray-light);border-radius:16px;padding:35px 25px;text-align:center;transition:transform 0.3s}.feature-card:hover{transform:translateY(-5px)}.feature-icon{width:70px;height:70px;background:rgba(245,158,11,0.15);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px}.feature-icon svg{width:32px;height:32px;fill:var(--orange)}.feature-card h3{font-size:18px;margin-bottom:10px;color:var(--white)}.feature-card p{color:#9CA3AF;font-size:14px;line-height:1.6}';
    html += '.cta{padding:60px 0;background:linear-gradient(135deg,var(--orange),#D97706);text-align:center}.cta h2{font-size:36px;color:var(--dark);margin-bottom:15px}.cta p{color:rgba(0,0,0,0.7);margin-bottom:25px;font-size:18px}.cta-phone{display:inline-flex;align-items:center;gap:12px;background:var(--dark);color:var(--orange);padding:18px 45px;border-radius:50px;text-decoration:none;font-family:"Oswald",sans-serif;font-size:24px;animation:glow 2s infinite}.cta-phone svg{width:28px;height:28px;fill:var(--orange)}';
    html += 'footer{background:var(--dark);border-top:1px solid var(--gray-light);padding:30px 0;text-align:center}footer p{color:#6B7280;font-size:13px;margin-bottom:10px}footer a{color:#6B7280;text-decoration:none;margin:0 10px}footer a:hover{color:var(--orange)}';
    html += '@media(max-width:1024px){.features-grid{grid-template-columns:repeat(2,1fr)}}';
    html += '@media(max-width:768px){.hero h1{font-size:36px}.features-grid{grid-template-columns:1fr}.search-form{flex-direction:column}.header-inner{flex-direction:column;gap:15px}.hero-buttons{flex-direction:column;padding:0 20px}.hero-buttons a{width:100%;justify-content:center}}';
    html += '</style></head><body>';
    html += '<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MFN4PQQD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>';
    
    html += '<svg style="display:none"><symbol id="i-phone" viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></symbol><symbol id="i-bolt" viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66l.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></symbol><symbol id="i-shield" viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></symbol><symbol id="i-euro" viewBox="0 0 24 24"><path d="M15 18.5c-2.51 0-4.68-1.42-5.76-3.5H15v-2H8.58c-.05-.33-.08-.66-.08-1s.03-.67.08-1H15V9H9.24C10.32 6.92 12.5 5.5 15 5.5c1.61 0 3.09.59 4.23 1.57L21 5.3C19.41 3.87 17.3 3 15 3c-3.92 0-7.24 2.51-8.48 6H3v2h3.06a8 8 0 000 2H3v2h3.52c1.24 3.49 4.56 6 8.48 6 2.31 0 4.41-.87 6-2.3l-1.78-1.77c-1.13.98-2.6 1.57-4.22 1.57z"/></symbol><symbol id="i-clock" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></symbol><symbol id="i-search" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></symbol></svg>';
    
    html += '<header><div class="header-inner"><a href="/" class="logo"><div class="logo-icon"><img src="/images/favicon.png" alt="Logo"></div><div class="logo-text">Ligne <span>Serrure</span></div></a><a href="tel:' + TEL_CLEAN + '" class="header-phone"><svg><use href="#i-phone"/></svg>' + TEL + '</a></div></header>';
    
    html += '<section class="hero"><div><h1>SERRURIER <span>URGENCE</span> 24H/24</h1><p>Intervention en 20 minutes partout en France - Devis gratuit</p><div class="hero-buttons"><a href="tel:' + TEL_CLEAN + '" class="btn-call"><svg><use href="#i-phone"/></svg>APPELER ' + TEL + '</a><a href="/autour-de-vous" class="btn-search"><svg><use href="#i-search"/></svg>TROUVER UN SERRURIER</a></div></div></section>';
    
    html += '<section class="search-section"><div class="search-box"><h2>RECHERCHER <span>VOTRE VILLE</span></h2><p>Entrez votre ville ou code postal pour trouver un serrurier pres de chez vous</p><form class="search-form" onsubmit="searchCity(event)"><input type="text" id="citySearch" placeholder="Paris, Lyon, 75001..." required><button type="submit">RECHERCHER</button></form></div></section>';
    
    html += '<section class="features"><div class="features-grid">';
    html += '<div class="feature-card"><div class="feature-icon"><svg><use href="#i-bolt"/></svg></div><h3>INTERVENTION 20 MIN</h3><p>Nos serruriers arrivent en 20 minutes maximum</p></div>';
    html += '<div class="feature-card"><div class="feature-icon"><svg><use href="#i-shield"/></svg></div><h3>CERTIFIE A2P</h3><p>Serrures agreees par les assurances</p></div>';
    html += '<div class="feature-card"><div class="feature-icon"><svg><use href="#i-euro"/></svg></div><h3>DEVIS GRATUIT</h3><p>Prix transparent et sans surprise</p></div>';
    html += '<div class="feature-card"><div class="feature-icon"><svg><use href="#i-clock"/></svg></div><h3>24H/24 - 7J/7</h3><p>Disponible jour et nuit, week-end et jours feries</p></div>';
    html += '</div></section>';
    
    html += '<section class="cta"><div><h2>BESOIN D\'UN SERRURIER ?</h2><p>Appelez maintenant pour une intervention immediate</p><a href="tel:' + TEL_CLEAN + '" class="cta-phone"><svg><use href="#i-phone"/></svg>' + TEL + '</a></div></section>';
    
    html += '<footer><p>2025 ' + MARQUE + ' - Serrurier Urgence 24h/24</p><p><a href="/mentions-legales">Mentions legales</a><a href="/confidentialite">Confidentialite</a><a href="/cgu">CGU</a></p></footer>';
    
    html += '<script>function searchCity(e){e.preventDefault();var city=document.getElementById("citySearch").value.trim().toLowerCase().replace(/\\s+/g,"-");window.location.href="/serrurier/"+encodeURIComponent(city);}</script>';
    html += '</body></html>';
    
    return new Response(html, { status: 200, headers: { "Content-Type": "text/html;charset=UTF-8" } });
}
